#!/bin/bash
music_dir=$XDG_DATA_HOME/fumpl
music_file=$music_dir/"$(ls $music_dir|fzf --reverse)"

# TODO: uses cut twice, I don't like it
choosing (){
	vid_selected="$(cut -d ',' -f 1 $music_file|sort|fzf --reverse)"
	[ -z "$vid_selected" ] && exit 0
	vid=$(grep "$vid_selected" $music_file|cut -d ',' -f 2)
	mpv --no-vid "$vid"
}

# one liner for shuffling
shuffle (){
	cut -d ',' -f 2 $music_file|shuf|xargs mpv --no-vid
}

# adding songs
adding (){
	read -p "Name of song: " song_name
	read -p "link/path to song: " link
	echo "$song_name,$link" >> $music_file
	echo "$song_name,$link" >> $music_dir/main
}

# main case
case "$1" in
	-s|--shuffle)	shuffle ;;
	-a|--adding)	adding ;;
	*)				while true;do choosing;done ;;
esac
